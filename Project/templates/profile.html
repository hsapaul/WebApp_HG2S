{% extends "template_base.html" %}

{% block title %}
HG2S - Profile
{% endblock %}

{% block content %}

<div class="">
    <h1 class="headline">Your Profile</h1>
    <p class="subheadline">Welcome <em>{{session['session_user']}}</em>. Have fun customizing your experience.</p>
</div>

<!-- Profile Picture -->

<div class="user-profile">

    <div class="row">
        <div class="col-6 py-4">
            <div class="card bgcolor_black text-white" style="border-radius: 1rem;">
                <div class="card-body p-5">
                    <h4>User Settings</h4>
                    <div class="">
                        <img class="" width="150" height="150"
                             src="{{ url_for('static', filename='img/profile_picture_default.jpg') }}"
                             alt="user">
                    </div>
                    <h4 class="d-inline">Username: </h4>
                    <p class="d-inline">{{ session_user }}</p>
                    <a href="/change_user_name">
                        <button>Change User Name</button>
                    </a>
                    <br>
                    <h4 class="d-inline">E-Mail: </h4>
                    {% if session['session_email'] %}
                    <p class="d-inline">{{ session['session_email'] }}</p>
                    <!--<a href="" class="d-inline"><button>Change E-Mail</button></a>-->
                    {% else %}
                    <p class="d-inline">No E-Mail given</p>
                    <a href="">
                        <button>Add</button>
                    </a>
                    {% endif %}
                    <br>
                    <h4 class="d-inline">Password: </h4>
                    <p class="d-inline">************</p>
                    <a href="/change_password">
                        <button>Change Password</button>
                    </a>
                    </form>
                    <a class="d-block mt-5" href='/logout'>Logout</a>
                </div>
            </div>
        </div>
        <div class="col-6 py-4">
            <div class="card bgcolor_black text-white" style="border-radius: 1rem;">
                <div class="card-body p-5">
                    <h4>Appearence</h4>
                    <form action="#" method="post">
                        <div class="outer_dark_mode_class mb-4 mt-3">
                            <div class="dark_mode_class">
                                <input id="dark_mode_switch" type="checkbox" name="dark_mode_checkbox" class="mx-2"
                                       checked>
                                <label id="dark_mode_label" for="dark_mode_switch" class="mx-5">Dark Mode</label>
                            </div>
                        </div>
                        <select class="form-select" name="form-select" aria-label="Default select example">
                            <option id="selected_theme" class="theme_items" selected>{{ session['session_theme'] }}
                            </option>
                            {% set theme_list = ["HG2S Original", "Purple Darkness", "Sunlight Avenue"] %}
                            {% for theme in theme_list %}
                            {% if theme != session['session_theme'] %}
                            <option class="theme_items" value="{{theme}}">{{ theme }}</option>
                            {% endif %}
                            {% endfor %}
                        </select>
                        <button class="btn btn-outline-light btn-lg px-5 mt-4"
                                id="submit_theme"
                                name="submit_theme" type="submit">
                            Commit
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="card bgcolor_black text-white" style="border-radius: 1rem;">
                <div class="card-body p-5">
                    <h4>Prompt History</h4>
                    {% if your_last_prompts|length > 0%}
                    {% for prompt in your_last_prompts %}
                    <div class="rounded border border-white text-light py-1 m-1">
                        <h6 class="">"{{ prompt.text_prompt }}"</h6>
                        <p class="d-inline m-1 small-font">{{ prompt.creation_date }}</p>
                        <p class="d-inline float-end left_bottom m-1 small-font"><a
                                href="{{ url_for('playground', text_prompt = prompt.text_prompt) }}">Playground</a>
                        </p>
                    </div>
                    {% endfor %}
                    <p style="line-height: 90%">Post your Prompt Creations to the Marketplace</p>
                    <a class="d-block" href="{{ url_for('index')}}">Prompt something new!</a>
                    {% else %}
                    <p class="">You didn't prompt yet!</p>
                    <div><p>Start <a class="d-inline" href="{{ url_for('index')}}">your first Prompt Creation</a>
                        Right
                        now!</p></div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<p id="exchange_appearance_js" style="display: none">{{ session['session_light_mode'] }}</p>
<script>

    var theme_selector = document.getElementsByClassName("form-select")[0];

    theme_selector.onchange = function () {
        if (this.value == "HG2S Original") {
            document.body.classList.remove("bgcolor_purple", "bgcolor_avenue");
            document.body.classList.add('bgcolor_original');
        } else if (this.value == "Purple Darkness") {
            document.body.classList.remove("bgcolor_original", "bgcolor_avenue");
            document.body.classList.add('bgcolor_purple');
        } else if (this.value == "Sunlight Avenue") {
            document.body.classList.remove("bgcolor_original", "bgcolor_purple");
            document.body.classList.add('bgcolor_avenue');
        }
    };


    ///////////////////////////////////////////////
    //////////// DARK MODE SWITCH /////////////////
    ///////////////////////////////////////////////

    // Get Dark Mode Switch
    const modeSwitch = document.getElementById("dark_mode_switch");
    // Get Dark Mode Label
    const modeLabel = document.getElementById('dark_mode_label');
    // Get Dark Mode Class
    const modeClass = document.getElementsByClassName('dark_mode_class');

    // Toggle to the right State when loading page
    const lightmode = document.getElementById("exchange_appearance_js");
    if (lightmode.innerHTML == 1) {
        modeSwitch.checked = true;
        modeLabel.innerHTML = "Light Mode";
    } else if (lightmode.innerHTML == 0) {
        modeSwitch.checked = false;
        modeLabel.innerHTML = "Dark Mode";
    }


    // Temporary direct Preview of the selected Theme and Mode
    modeSwitch.addEventListener("change", function () {
        // Change Dark Mode Label
        if (modeSwitch.checked == false) {
            modeLabel.innerHTML = "Dark Mode";
            change_appearance(false);
        } else {
            modeLabel.innerHTML = "Light Mode";
            change_appearance(true);
        }
    });

    function change_appearance(bool) {
        // Switches
        var textColor = !bool ? "color_white" : "color_black";
        var bgColor = !bool ? "bgcolor_black" : "bgcolor_white";
        var bgColor_secondary = !bool ? "bgcolor_darkgrey" : "bgcolor_lightgrey";
        var remove_secondary = !bool ? "bgcolor_lightgrey" : "bgcolor_darkgrey";

        // Change Body BG Color
        var pageContent = document.getElementsByClassName("page-content")[0];
        pageContent.classList.add(bgColor);
        pageContent.classList.remove("bg" + textColor);

        // Change paragraph and all headings text color
        pageContent.querySelectorAll("p, h1, h2, h3, h4, h5, h6").forEach(function (el) {
            el.classList.add(textColor);
            el.classList.remove(bgColor.replace("bg", ""));
        });

        // Change Card BG color
        document.querySelectorAll(".card").forEach(function (card) {
            card.classList.add(bgColor_secondary);
            card.classList.remove(remove_secondary);
        });

    }

</script>

{% endblock %}